<div class="card mb-4">
  <div class="card-header">
    <h6 class="mb-0">
      <i class="bi bi-funnel"></i>
      Filters
      <button class="btn btn-sm btn-outline-secondary ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#filterCollapse">
        Toggle
      </button>
    </h6>
  </div>
  <div class="collapse" id="filterCollapse">
    <div class="card-body">
      <%= form_with url: request.path, method: :get, local: true, class: "row g-3" do |f| %>
        <div class="col-md-3">
          <%= f.label :event, class: "form-label" %>
          <%= f.select :event, 
              options_for_select([["All Events", ""]] + available_events.map { |e| [e.humanize, e] }, params[:event]),
              {}, { class: "form-select" } %>
        </div>
        
        <% if available_whodunnits %>
          <div class="col-md-3">
            <%= f.label :whodunnit, "Who", class: "form-label" %>
            <%= f.select :whodunnit,
                options_for_select([["Anyone", ""]] + available_whodunnits.map { |w| [w || "System", w] }, params[:whodunnit]),
                {}, { class: "form-select" } %>
          </div>
        <% end %>
        
        <div class="col-md-2">
          <%= f.label :from_date, "From Date", class: "form-label" %>
          <%= f.date_field :from_date, value: params[:from_date], class: "form-control" %>
        </div>
        
        <div class="col-md-2">
          <%= f.label :to_date, "To Date", class: "form-label" %>
          <%= f.date_field :to_date, value: params[:to_date], class: "form-control" %>
        </div>
        
        <div class="col-md-2">
          <%= f.label :search, "Search Changes", class: "form-label" %>
          <%= f.text_field :search, value: params[:search], class: "form-control", placeholder: "Search..." %>
        </div>
        
        <div class="col-12">
          <div class="d-flex gap-2">
            <%= f.submit "Apply Filters", class: "btn btn-primary" %>
            <%= link_to "Clear", request.path, class: "btn btn-outline-secondary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>